- title = @trip&.title || t("pages.home.title")
- set_meta_tags title: title, description: t("pages.home.description"), keywords: t("pages.home.keywords")

- if @trip.present?
  /- Part 1: Trip selector
  .trip-selector.text-center.mb-4
    - if @trips.size == 1
      %h2= @trip.title
    - else
      .dropdown
        %button.btn.btn-outline-secondary.dropdown-toggle{type: "button", "data-bs-toggle" => "dropdown"}
          = @trip.title
        %ul.dropdown-menu
          - @trips.each do |trip|
            %li
              = link_to trip.title, root_path(trip: trip.id), class: "dropdown-item #{'active' if trip == @trip}"

  /- Part 2: Day navigator (shown when multiple items to navigate)
  :ruby
    include_intro = @days.any?
    items = navigator_items(@days, include_intro)
    current = current_item(@day, @show_intro)
  - if show_day_navigator?(@days, include_intro)
    .day-navigator.text-center.mb-4
      /- First/last arrows (only when items > WINDOW_SIZE)
      - if show_nav_arrows?(@days, include_intro)
        - if at_first_position?(items, current)
          %span.nav-arrow.disabled= t("symbol.first")
        - else
          = link_to t("symbol.first"), first_position_path(items, @trip), class: "nav-arrow"

      /- Previous arrow (always shown in navigator)
      - if at_first_position?(items, current)
        %span.nav-arrow.disabled= t("symbol.previous")
      - else
        = link_to t("symbol.previous"), previous_position_path(items, current, @trip), class: "nav-arrow"

      .day-links.d-inline
        - item_window(items, current).each do |item|
          - if item == :intro
            - if @show_intro
              %span.current-day= t("trip.intro")
            - else
              = link_to t("trip.intro"), root_path(intro: true, trip: @trip.id), class: "day-link"
          - elsif item == @day
            %span.current-day
              %span.d-md-none= day_label(item, long: false)
              %span.d-none.d-md-inline= day_label(item)
          - else
            = link_to root_path(day: item.id), class: "day-link" do
              %span.d-md-none= day_label(item, long: false)
              %span.d-none.d-md-inline= day_label(item)

      /- Next arrow (always shown in navigator)
      - if at_last_position?(items, current)
        %span.nav-arrow.disabled= t("symbol.next")
      - else
        = link_to t("symbol.next"), next_position_path(items, current), class: "nav-arrow"

      /- Last arrow (only when items > WINDOW_SIZE)
      - if show_nav_arrows?(@days, include_intro)
        - if at_last_position?(items, current)
          %span.nav-arrow.disabled= t("symbol.last")
        - else
          = link_to t("symbol.last"), last_position_path(items), class: "nav-arrow"

  /- Part 3: Day date (hidden when on Intro)
  - unless @show_intro
    .day-date.text-center.mb-4
      %span.current-day= day_date(@day, long: true)

  /- Part 4: Day/Intro title
  .day-title.text-center.mb-4
    - if @show_intro
      %h3= t("trip.introduction")
    - else
      %h3= @day.title

  /- Part 5: Content (trip notes for intro, day notes for days)
  .day-content
    - if @show_intro
      - if @trip.notes.present?
        .content= @trip.html(guest: true)
    - elsif @day&.notes.present?
      .content= @day.html(guest: true)

/- Part 6: Admin link (always shown)
.admin-link.text-center.mt-5
  %small.text-muted
    - if current_user.guest?
      = link_to t("session.sign_in"), new_session_path, class: "text-muted"
    - else
      = link_to t("user.admin"), admin_return_path, class: "text-muted"
